<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>You are on your own kid</title>
    <link rel="icon" type="image/png" href="icon.png"></link>
    <link rel="stylesheet" type="text/css" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">   
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="main.js"></script>
</head>
<body>
    <form>
        <div class="divCabecera">
            <img src="eras.png" class="imagen-titulo">
        </div>
        <div class="divInstrucciones">
            <h1 class="titulo-instrucciones">Instrucciones</h1>
            <p class="contenido-instrucciones">
            <span >Da click al casillero de la letra que tenés y elegí la cantidad. Cuando hayas ingresado
                todas, apreta el botón de</span><span class="calcular-contenido">calcular</span>
            </p>
            <span class="contenido-instrucciones">Debajo aparecerá un listado por cada era.</span>
        </div>
        <div id="contenedorEntradas" class="contenedorEntradas"></div>
        <div class="btn">
            <button type="button" id="botonCalcular" class="btnCalcular">CALCULAR</button>
        </div>
        <div class="albumListas" id="albumListas"></div>
        <div class="contenedorTablas">
            <div id="tablaDebut"  class="album-container"></div>
            <div id="tablaFearless"  class="album-container"></div>
            <div id="tablaSpeakNow"  class="album-container"></div>
            <div id="tablaRed"  class="album-container"></div>
            <div id="tabla1989"  class="album-container"></div>
            <div id="tablaRep"  class="album-container"></div>
            <div id="tablaLover"  class="album-container"></div>
            <div id="tablaFolklore"  class="album-container"></div>
            <div id="tablaEvermore"  class="album-container"></div>
            <div id="tablaMid"  class="album-container"></div>
            <div id="tablaRandom"  class="album-container"></div>
        </div>
     <footer>
         <div class="social">
             <a href='https://github.com/ludmilaboffo'  target="_blank"><i class="fa-brands fa-github-alt"></i> </a>   
             <a href="https://cafecito.app/aphroditespell" target="_blank"><i class="fas fa-coffee" ></i></a>                    
         </div>
         <div class="div-audio">
             <audio controls autoplay>
              <source src="YOYOK.mp3">
            </audio>
         </div>
     </footer>
    </form> 

    <script type="text/javascript">

        var entradas = [
            { letra: 'A', cantidad: 25 }, 
            { letra: 'B', cantidad: 25 },
            { letra: 'C', cantidad: 26 },
            { letra: 'D', cantidad: 10 },
            { letra: 'E', cantidad: 10 },
            { letra: 'F', cantidad: 10 },
            { letra: 'G', cantidad: 10 }, 
            { letra: 'H', cantidad: 10 },
            { letra: 'I', cantidad: 10 },
            { letra: 'J', cantidad: 10 },
            { letra: 'K', cantidad: 10 },
            { letra: 'L', cantidad: 10 },
            { letra: 'M', cantidad: 10 }, 
            { letra: 'N', cantidad: 10 },
            { letra: 'O', cantidad: 10 },            
            { letra: 'P', cantidad: 10 },
            { letra: 'Q', cantidad: 10 },
            { letra: 'R', cantidad: 10 },
            { letra: 'S', cantidad: 10 },
            { letra: 'T', cantidad: 10 }, 
            { letra: 'U', cantidad: 10 },
            { letra: 'V', cantidad: 10 },
            { letra: 'W', cantidad: 10 },
            { letra: 'Y', cantidad: 10 },
            { letra: 'Z', cantidad: 10 },
        ];


        $(document).ready(() => {

            for (var entrada of entradas) {

                $("#contenedorEntradas").append(`<div>
                    <label class="label-letra">${entrada.letra}</label>
                    <input type="checkbox" class="checkbox-letra" data-letra="${entrada.letra}" id="letra-${entrada.letra}">
                    <input type="number" min="0" id="cantidad-${entrada.letra}" value="${entrada.cantidad}">
                </div>`);

            }

            $("#botonCalcular").click(() => {

                var datosIngresados = [];

                $(".checkbox-letra:checked").each((i, element) => {

                    var letra = $(element).data('letra');
                    var cant = $("#cantidad-" + letra).val();

                    datosIngresados.push({ letra: letra, cantidad: +cant });
                });
                
                //----------------- DEBUT
                
                var imgDebut= "debut.png";
                var listaDebut = listadoFinal(datosIngresados, arrayDebut);
                crearTabla(listaDebut, imgDebut, "tablaDebut");

                //--------------- FEARLESS                
                var imgF= "fearless.png";
                var listaFear = listadoFinal(datosIngresados, arrayFearless);
                crearTabla(listaFear, imgF, "tablaFearless");

                //----------------- SPEAK NOW
                
                var imgSP= "speak-now.webp";
                var listaSP = listadoFinal(datosIngresados, arraySPNow);
                crearTabla(listaSP, imgSP, "tablaSpeakNow");
                //--------------- RED
                var imgRed= "red.webp";
                var listaRed= listadoFinal(datosIngresados, arrayRed);
                crearTabla(listaRed, imgRed, "tablaRed");                
                //----------------- 1989
                
                var img1989= "1989.png";
                var lista1989 = listadoFinal(datosIngresados, array1989);
                crearTabla(lista1989, img1989, "tabla1989");
                //--------------- REP

                var imgRep= "rep.png";
                var listaRep = listadoFinal(datosIngresados, arrayReputation);
                crearTabla(listaRep, imgRep, "tablaRep");
                //----------------------- LOVER
                
                var imgLover= "lover.png";
                var listaLover = listadoFinal(datosIngresados, arrayLover);
                crearTabla(listaLover, imgLover, "tablaLover");
                //----------------- FOLKLORE
                
                var imgFolklore= "folklore.png";
                var listaFolk = listadoFinal(datosIngresados, arrayFolklore);
                crearTabla(listaFolk, imgFolklore, "tablaFolklore");
                //--------------- EVERMORE

                var imgEvermore= "evermore.png";
                var listaEver = listadoFinal(datosIngresados, arrayEvermore);
                crearTabla(listaEver, imgEvermore, "tablaEvermore");

                //----------------- MIDNIGHTS
                
                var imgMid= "midnights.png";
                var listaMid = listadoFinal(datosIngresados, arrayMid);
                crearTabla(listaMid, imgMid, "tablaMid");

            });

        });


        function listadoFinal(datosIngresados, listadoCanciones){
            var listado = [ ];

            for(var i = 0; i< listadoCanciones.length; i++){
                var cancion = listadoCanciones[i];
                var valido = comprobarFrase2(datosIngresados, cancion);
                if(valido){
                    listado.push(cancion);
                }
            }
                console.log(listado);
                return listado;
        }

        

        function comprobarFrase2(datosIngresados, frase) {

            var letrasFrase = [];
            frase = frase.replace(/ /g, '');

            for (var caracter of frase) {
                
                var letraExistente = letrasFrase.find((i) => i.letra == caracter);
                if (letraExistente) {
                    letraExistente.cantidad++;
                } else {
                    letrasFrase.push({ letra: caracter, cantidad: 1 });
                }

            }

            for (var letraFrase of letrasFrase) {

                var di = datosIngresados.find((i) => i.letra == letraFrase.letra);

                if (!di) {
                    return false;
                }
                
                if (di.cantidad < letraFrase.cantidad) {
                    return false;
                }

            }

            return true;

        }

        function crearTabla(lista, urlImagen, id) {
            var contenidoContenedor = `
                
                    <img src="${urlImagen}" class="imagen-encabezado">
                    <ul>
            `;

            for (var i = 0; i < lista.length; i++) {
                contenidoContenedor += "<li class='canciones-li'>" + lista[i] + "</li>";
            }

            contenidoContenedor += `
                    </ul>
               
            `;

            $("#" + id).html(contenidoContenedor);
        }
    </script>

    </body>
</html>